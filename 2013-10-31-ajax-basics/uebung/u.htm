<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Ajax Tutorial</title>
    <link rel="stylesheet" type="text/css" href="u.css">
    

    
<!--
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function() {

            //assign your api key equal to a variable
            var apiKey = '4ef2fe2affcdd6e13218f5ddd0e2500d';
            var searchText = 'modern architecture'

            //json request to flickr
            $.getJSON('http://api.flickr.com/services/rest/?&method=flickr.photos.search&api_key=' + apiKey + '&text=' + searchText + '&sort=relevance&per_page=55&format=json&jsoncallback=?',
                function(data) {
                    $.each(data.photos.photo, function(i, item) {

                        //build the url of the photo in order to link to it
                        var photoURL = 'http://farm' + item.farm + '.static.flickr.com/' + item.server + '/' + item.id + '_' + item.secret + '_m.jpg';

                        //turn the photo id into a variable
                        var photoID = item.id;

                        var imgCont = '<img class="image-container" src="' + photoURL + '">';


                        //append the 'imgCont' variable to the document
                        $(imgCont).appendTo('#container');


                    });
                });

            jQuery('#loader').remove();

        });
    </script>

--->
    <script>
        var apiKey = '4ef2fe2affcdd6e13218f5ddd0e2500d';
        var searchText = 'modern architecture'
        var pageId = 1;
        
        function formatResponseDataToJSON(data){
            var json
            try {
                data = data.substring(data.indexOf('(') + 1, data.lastIndexOf(')'));
                json = JSON && JSON.parse(data);
            } catch (e) {
                alert("Parsing error:" + e);
            }
            return json;
        }

        function loadXMLDoc() {
            var requestURL = 'http://api.flickr.com/services/rest/?&method=flickr.photos.search&api_key=' + apiKey + '&text=' + searchText + '&page=' + pageId + '&sort=relevance&per_page=5&format=json&jsoncallback=?';

            
            
            var xmlhttp;
            if (window.XMLHttpRequest) { 
                // code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            } else { 
                // code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    pageId++;
                    
                    var data = xmlhttp.responseText;
                    
                    var json = formatResponseDataToJSON(data);

                   // alert("success");
                    //alert(json.photos.photo.length);

                    
                    for (var i = 0; i < json.photos.photo.length; i++) {
                        var item = json.photos.photo[i];
                        var photoURL = 'http://farm' + item.farm + '.static.flickr.com/' + item.server + '/' + item.id + '_' + item.secret + '_m.jpg';
                        var imgCont = '<img src="' + photoURL + '">';

                        
                        document.getElementById("container").innerHTML += imgCont;
                        
                    }
                    
                    document.getElementById("controls").children[0].removeAttribute("disabled");
                    document.getElementById("status").innerHTML = "Fertig geladen";
                    
                }
                
                if(xmlhttp.readyState == 1){
                    
                    document.getElementById("controls").children[0].disabled="disabled";
                    document.getElementById("status").innerHTML = "Lade...";
                }
                
            }
            xmlhttp.open("GET", requestURL, true);
            xmlhttp.send();
        }
    </script>
</head>

<body>
    <div id="container">
        <!-- HIER DIE BILDER REINLADEN -->
    </div>
    <div id="controls">
        <input type="button" value="Mehr Bilder" onClick="loadXMLDoc();" />
        <div id="status"></div>
    </div>
</body>


</html>